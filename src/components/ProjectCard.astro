---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import placeholder from "../assets/placeholder.jpeg";

interface Props {
  project: {
    demo_link?: string;
    source_link: string;
    image: string;
    alt: string;
    heading: string;
    text: string;
  };
}

const { project } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/*.{jpeg,jpg,png,webp,avif}",
);
const projectImagePath = images[`/src/assets/${project.image}`];
---

<li class="project-card">
  <figure class="project-card__image-container">
    <a href={project.demo_link ?? project.source_link}>
      <Image
        src={typeof projectImagePath === "function"
          ? projectImagePath()
          : placeholder}
        alt={project.alt}
        width={800}
        height={450}
        format="webp"
      />
    </a>
    <figcaption class="project-text">
      <h3>{project.heading}</h3>
      <p>{project.text}</p>
    </figcaption>
  </figure>

  <div class="project__links-container">
    {
      project.demo_link && (
        <a href={project.demo_link} class="project__link">
          demo
        </a>
      )
    }
    <a href={project.source_link} class="project__link">source code</a>
  </div>
</li>

<style>
  .project-card {
    outline: 2px solid var(--outline-color-secondary);
    user-select: none;
    cursor: pointer;
    overflow: hidden;
    transition:
      outline var(--transition),
      box-shadow var(--transition);

    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .project-card:hover {
    outline-color: var(--outline-color);
    box-shadow: 0 5px 20px -2px var(--outline-color-mute);
  }

  .project-card a {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .project-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    aspect-ratio: 16/9;
  }

  .project-text {
    padding: 1rem;
  }

  .project-text h3 {
    margin-block: 0 0.5rem;
    line-height: 1.2;
  }

  .project__links-container {
    display: flex;
    justify-content: center;
  }

  .project__link {
    outline: 2px solid var(--accent);
    flex: 1 1 0;
    padding-block: 1rem;
    text-align: center;
    transition: background-color 200ms ease;
  }

  a.project__link:hover,
  .project__link:focus-visible {
    background: var(--primary);
  }
</style>
